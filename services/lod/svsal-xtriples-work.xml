<xtriples xml:base="https://id.salamanca.school/">
    <configuration>
        <vocabularies>
            <!-- Input vocabularies -->
            <vocabulary prefix="tei"   uri="http://www.tei-c.org/ns/1.0"/>
            <vocabulary prefix="xi"    uri="http://www.w3.org/2001/XInclude"/>
            <vocabulary prefix="sal"   uri="http://salamanca.adwmainz.de"/>    
            <vocabulary prefix="itei"  uri="https://www.salamanca.school/indexed-tei"/>

            <!-- Output vocabularies -->
            <vocabulary prefix="rdf"   uri="http://www.w3.org/1999/02/22-rdf-syntax-ns#"/>
            <vocabulary prefix="rdfs"  uri="http://www.w3.org/2000/01/rdf-schema#"/>
            <vocabulary prefix="owl"   uri="http://www.w3.org/2002/07/owl#"/>        

            <vocabulary prefix="void"  uri="http://rdfs.org/ns/void#"/>
            <vocabulary prefix="iiif"  uri="http://iiif.io/api/presentation/2.1/"/>
            <vocabulary prefix="foaf"  uri="http://xmlns.com/foaf/0.1/"/>            
            <vocabulary prefix="book"  uri="http://schema.org/Book/"/>               
            <vocabulary prefix="fabio" uri="http://purl.org/spar/fabio/"/>           
            <vocabulary prefix="cito"  uri="http://purl.org/spar/cito/"/>            
            <vocabulary prefix="doco"  uri="http://purl.org/spar/doco/"/>            
            <vocabulary prefix="po"    uri="http://www.essepuntato.it/2008/12/pattern#"/> 
<!--            <vocabulary prefix="c40"   uri="http://purl.org/spar/c4o"/>              -->
<!--            <vocabulary prefix="deo"   uri="http://purl.org/spar/deo"/>              -->
<!--            <vocabulary prefix="co"    uri="http://purl.org/co/"/>                   -->
        </vocabularies>

        <triples>

       <!-- NOTE: in the following, "WXXXX" within @prepend is a placeholder that gets replaced by the actual
            work id through createConfig.xql -->     

<!-- TODO/General:
    - Try to get rid of string() so that values are not isolated from their (indexed) nodes (ML suggestion by Joe Wicentowski)
    - better use union of full xpaths than or'ing predicates/conditions (intersect instead of and'ing, too?)
-->

<!-- TODO refactoring/testing: reset minimum thresholds in @repeat attributes to a higher value in order to catch all resources -->

            <statement n="001">
                <condition>/boolean($currentResource/tei:teiHeader[not(.//tei:relatedItem[@type eq 'completeWork'])])</condition> <!-- produce void.ttl link only once -->
                <subject type="uri"/>
                <predicate prefix="void">inDataset</predicate>
                <object type="uri" prepend="https://api.salamanca.school/v1/">void.ttl#Salamanca</object>
            </statement>


<!-- ============================================================= -->
<!-- === I. Bibliographic Metadata: Type, Title, Creator, Year === -->  
<!-- ============================================================= -->

            <statement n="100"><!-- a fabio:work -->
                <subject type="uri" prepend="texts/">/($currentResource[not(@type="work_volume")]/@docId)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">work</object>
            </statement>

            <statement n="101"><!-- fabio:hasTitle -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject> <!-- /@work -->
                <predicate prefix="fabio">hasTitle</predicate>
                <object type="literal">/($currentResource/tei:teiHeader/tei:fileDesc/tei:titleStmt/tei:title[@type eq 'main']/text())</object>
            </statement>

            <statement n="102"><!-- fabio:has short title -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasShortTitle</predicate>
                <object type="literal">/replace($currentResource/tei:teiHeader//tei:titleStmt//tei:title[@type="short"], '"', '\\"')</object>
            </statement>

            <statement n="103"><!-- fabio:hasCreator -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasCreator</predicate>
                <object type="uri" prepend="authors.">(for $t in $currentResource/tei:teiHeader//tei:titleStmt//tei:author/tei:persName/tokenize(tokenize(@ref, 'author:')[2], ' ')[1] return element t {$t})</object>
            </statement>

            <statement n="104"><!-- fabio:has volume count -->
                <condition>/($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasVolumeCount</predicate>
                <object type="literal">/count($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_volume"])</object>
            </statement>

            <statement n="105"><!-- fabio:hasPublicationYear -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublicationYear</predicate>
                <object type="literal">/($currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:date[@type eq 'thisEd'], tei:date[@type eq 'firstEd'])[1]/@when)</object>
            </statement>

            <statement n="106"><!-- fabio:has publisher (in cerl) -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublisher</predicate>
                <object type="uri" prepend="http://thesaurus.cerl.org/record/">/(for $t in $currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:publisher[@n='thisEd'], tei:publisher[@n='firstEd'])[1]/tei:persName/tokenize(tokenize(@ref,'cerl:')[2], ' ')[1] return element t {$t})</object>
            </statement>

            <statement n="107"><!-- fabio:has publisher (in gnd) -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasPublisher</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/(for $t in $currentResource/tei:teiHeader//tei:sourceDesc//tei:imprint/(tei:publisher[@n='thisEd'], tei:publisher[@n='firstEd'])[1]/tei:persName/tokenize(tokenize(@ref,'gnd:')[2],' ')[1] return element t {$t})</object>
            </statement>

            <statement n="108"><!-- fabio: has language -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="fabio">hasLanguage</predicate>
                <object type="literal">/($currentResource/tei:teiHeader/tei:profileDesc/tei:langUsage/tei:language/text())</object>
            </statement>

            <!-- is the id. URI actually necessary? -->
            <statement n="109"><!-- rdfs:seeAlso SvSal work full id -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="texts/">/($currentResource/@docId)</object>
            </statement>

            <statement n="110"><!-- rdfs:seeAlso SvSal work webpage (reading view) -->
                <!-- for whole works, we need to build the .html link "directly" (volumes are configured below) -->
                <condition>/boolean(not($currentResource/tei:teiHeader//tei:relatedItem[@type eq "work_multivolume"]))</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/work.html?wid=">/($currentResource/@docId)</object>
            </statement>

            <!-- TODO/Bibliographic:
                - work/volume as part of a (digital) series
                - fabio:has page count
                - deo:dedication
                - book:mentions (organisations)
                - cito:isCitedBy?
                ! test reification of cito:cites in order to associate po:isContainedBy
                ! corresponds to an oclc dataset?
            -->

<!-- =================================================================== -->
<!-- === II. Document Components: Volumes, Sections, Paragraphs etc. === -->
<!-- =================================================================== -->

<!-- Todo/Document Components:
    - items and lists, of dictionary entries in particular
-->

    <!-- For each document component, we record
            (1) its type,
            (2) a label, and
            (3) by which other component it is contained
            (4) where to find the html version of it -->

            <!-- '[@citeID]' makes sure that we only capture components that are actually indexed (= have a citeID) -->


            <!-- Volume -->

            <statement n="200"> <!-- doco part -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition> <!-- if metadata refer to complete work, the current resource must be related to a volume -->
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">part</object>
            </statement>

            <statement n="201"> <!-- rdfs label -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/string-join((replace($currentResource/tei:teiHeader//tei:titleStmt//tei:title[@type="short"], '"', '\\"'), concat('Volume ', $currentResource/tei:teiHeader//tei:sourceDesc/tei:biblStruct/tei:series/tei:biblScope/@n)), ', ')</object>
            </statement>

            <statement n="202"> <!-- po isContainedBy -->
                <condition>/boolean($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"])</condition>
                <subject type="uri" prepend="texts/">/($currentResource/@docId)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(substring-after($currentResource/tei:teiHeader//tei:relatedItem[@type eq "completeWork"][1]/@target, 'work:'))</object>
            </statement>

            <statement n="203"> <!-- rdfs seeAlso -->
                <condition>/boolean($currentResource[@type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[@type eq "work_volume"]/@citeID)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource[@type eq "work_volume"]/@web)</object>
			</statement>

            <!-- Frontmatter -->   

            <statement n="204"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">front-matter</object>
            </statement>

            <statement n="205"> <!-- rdfs label: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/concat('frontmatter of volume ', $currentResource/@n)</object>
            </statement>

            <statement n="206"> <!-- rdfs label: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">frontmatter</object>
            </statement>

            <statement n="207"> <!-- po isContainedBy: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citableParent)</object>
            </statement>

            <statement n="208"> <!-- po isContainedBy: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/($currentResource/@in)</object>
            </statement>

            <statement n="209"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:front/@citeID)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="http://www.salamanca.school/">/($currentResource/itei:front/@web)</object>
			</statement>

            <!-- Backmatter -->

            <statement n="210"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">back-matter</object>
            </statement>

            <statement n="211"> <!-- rdfs label: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/concat('backmatter of volume ', $currentResource/@n)</object>
            </statement>

            <statement n="212"> <!-- rdfs label: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">backmatter</object>
            </statement>

            <statement n="213"> <!-- po isContainedBy: multiple volumes -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_volume"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citableParent)</object>
            </statement>

            <statement n="214"> <!-- po isContainedBy: monograph -->
                <condition>/boolean($currentResource[self::itei:text and @type eq "work_monograph"])</condition>
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/($currentResource/@in)</object>
            </statement>

            <statement n="215"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource/itei:back/@citeID)</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="http://www.salamanca.school/">/($currentResource/itei:back/@web)</object>
			</statement>

            <!-- div -->

            <statement n="216" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citeID])))}"> <!-- doco type -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">/(if (($currentResource/descendant::itei:div[@citeID])[$repeatIndex]/@type eq 'book') then 'part' else if (($currentResource/descendant::itei:div[@citeID])[$repeatIndex]/@type eq 'chapter') then 'chapter' else 'section')</object>
            </statement>

            <statement n="217" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource/descendant::itei:div[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="218" repeat="{/min((100020, count($currentResource[self::itei:text]/descendant::itei:div[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:div[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:div[@citeID])[$repeatIndex]/@citableParent) then concat($currentResource/@in, ':', ($currentResource//itei:div[@citeID])[$repeatIndex]/@citableParent) else $currentResource/@in)</object>
            </statement>

            <statement n="219" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:div[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:div[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:div[@citeID])[$repeatIndex]/@web</object>
            </statement>

            <!-- head -->
<!--            
            <statement n="260"> <!-\- doco type -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:head[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">title</object>
            </statement>
            
            <statement n="261" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citeID])))}"> <!-\- rdfs label -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]/descendant::itei:head[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/normalize-space(replace(($currentResource/descendant::itei:head[@citeID])[$repeatIndex], '"', '\\"'))</object>
            </statement>
            
            <statement n="262" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citeID])))}"> <!-\- po isContainedBy -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:head[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:head[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>
            
            <statement n="263" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:head[@citeID])))}"> <!-\- rdfs seeAlso -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource//itei:head[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:head[@citeID])[$repeatIndex]/@web</object>
            </statement>
-->            
            <!-- p -->

            <statement n="220" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citeID])))}"> <!-- doco paragraph -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">paragraph</object>
            </statement>

            <statement n="221" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:p[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="222" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:p[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="223" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:p[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:p[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:p[@citeID])[$repeatIndex]/@web</object>
	        </statement>

            <!-- signed -->
<!--            
            <statement n="270" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citeID])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">paragraph</object>
            </statement>
            
            <statement n="271" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citeID])))}"> <!-\- rdfs label -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:signed[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="272" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citeID])))}"> <!-\- po isContainedBy -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:signed[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>
            
            <statement n="273" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:signed[@citeID])))}"> <!-\- rdfs seeAlso -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:signed[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:signed[@citeID])[$repeatIndex]/@web</object>
            </statement>
-->            
            <!-- argument -->
<!--            
            <statement n="270" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citeID])))}">
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>
            
            <statement n="271" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citeID])))}"> <!-\- rdfs label -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:argument[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="272" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citeID])))}"> <!-\- po isContainedBy -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:argument[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>
            
            <statement n="273" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:argument[@citeID])))}"> <!-\- rdfs seeAlso -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:argument[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:argument[@citeID])[$repeatIndex]/@web</object>
            </statement>
-->            
            <!-- lg -->

            <statement n="280" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citeID])))}"> <!-- doco stanza -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">stanza</object> <!-- alternatives: "paragraph" -->
            </statement>

            <statement n="281" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:lg[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="282" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:lg[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="283" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:lg[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:lg[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:lg[@citeID])[$repeatIndex]/@web</object>
            </statement>

            <!-- table -->

            <statement n="280" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citeID])))}"> <!-- doco table -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">table</object>
            </statement>

            <statement n="281" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:table[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="282" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:table[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="283" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:table[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:table[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource/descendant::itei:table[@citeID])[$repeatIndex]/@web</object>
            </statement>

            <!-- titlePage -->

            <statement n="224"> <!-- fabio page -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">page</object>
            </statement>

            <statement n="225" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/(if (starts-with($currentResource/@citeID, 'vol')) then ("Title page of volume " || replace((tokenize($currentResource/@citeID, '.'))[1], 'vol', '')) else "Title page")</object>
            </statement>

            <statement n="226" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:titlePage[@citeID])[$repeatIndex]/@citableParent) then concat($currentResource/@in, ':', ($currentResource//itei:titlePage[@citeID])[$repeatIndex]/@citableParent) else $currentResource/@in)</object>
            </statement>

            <statement n="227" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePage[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePage[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:titlePage[@citeID])[$repeatIndex]/@web</object>
            </statement>

            <!-- titlePart -->

            <statement n="228"> <!-- doco title -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">title</object>
            </statement>

            <statement n="229" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/normalize-space(replace(($currentResource//itei:titlePart[@citeID])[$repeatIndex], '"', '\\"'))</object>
            </statement>

            <statement n="230" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:titlePart[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:titlePart[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="231" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:titlePart[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource//itei:titlePart[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:titlePart[@citeID])[$repeatIndex]/@web</object>
            </statement>

            <!-- milestones -->

            <statement n="232"> <!-- doco section -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>

            <statement n="233" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:milestone[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="234" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:milestone[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="235" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:milestone[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:milestone[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:milestone[@citeID])[$repeatIndex]/@web</object>
			 </statement>

            <!-- list -->

            <statement n="236"> <!-- doco list -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">list</object>
            </statement>

            <statement n="237" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:list[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="238" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:list[@citeID])[$repeatIndex]/@citableParent) then concat($currentResource/@in, ':', ($currentResource//itei:list[@citeID])[$repeatIndex]/@citableParent) else $currentResource/@in)</object>
            </statement>

            <statement n="239" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:list[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:list[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:list[@citeID])[$repeatIndex]/@web</object>
			</statement>

            <!-- item -->
<!--            
            <statement n="240"> <!-\- doco section -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">section</object>
            </statement>
            
            <statement n="241" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citeID])))}"> <!-\- rdfs label -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:item[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>
            
            <statement n="242" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citeID])))}"> <!-\- po isContainedBy -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/(if (($currentResource//itei:item[@citeID])[$repeatIndex]/@citableParent) then concat($currentResource/@in, ':', ($currentResource//itei:item[@citeID])[$repeatIndex]/@citableParent) else $currentResource/@in)</object>
            </statement>
            
            <statement n="243" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:item[@citeID])))}"> <!-\- rdfs seeAlso -\->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:item[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:item[@citeID])[$repeatIndex]/@web</object>
			</statement>
-->            
            <!-- notes -->

            <statement n="244"> <!-- doco footnote -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">footnote</object>
            </statement>

            <statement n="245" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:note[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="246" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:note[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="247" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:note[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:note[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:note[@citeID])[$repeatIndex]/@web</object>
			</statement>

            <!-- label (all - should we differentiate further wrt @place? ) -->

            <statement n="248"> <!-- doco label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="doco">label</object>
            </statement>

            <statement n="249" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(($currentResource//itei:label[@citeID])[$repeatIndex]/@title, '"', '\\"')</object>
            </statement>

            <statement n="250" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/WXXXX:">/($currentResource//itei:label[@citeID])[$repeatIndex]/@citableParent</object>
            </statement>

            <statement n="251" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:label[@citeID])))}"> <!-- rdfs seeAlso -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:label[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:label[@citeID])[$repeatIndex]/@web</object>
			 </statement>


<!-- ==================================== -->
<!-- === III. Physical Aspects: Pages === -->
<!-- ==================================== -->

            <!-- pages -->

            <statement n="300"> <!-- fabio page -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID]/@citeID)</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="fabio">page</object>
            </statement>

            <statement n="301" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citeID])))}"> <!-- rdfs label -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">label</predicate>
                <object type="literal">/replace(normalize-space(($currentResource//itei:pb[@citeID])[$repeatIndex]/@title), '"', '\\"')</object>
            </statement>

            <statement n="302" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citeID])))}"> <!-- po isContainedBy -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="po">isContainedBy</predicate>
                <object type="uri" prepend="texts/">/('abcdefg')</object>
                <!-- /(if (($currentResource//itei:pb[@citeID])[$repeatIndex]/@citableParent ne '') then concat($currentResource/@in, ':', ($currentResource//itei:pb[@citeID])[$repeatIndex]/@citableParent) else $currentResource/@in) -->
            </statement>

            <statement n="303" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citeID])))}"> <!-- rdfs seeAlso image jpg -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://facs.salamanca.school/iiif/image/">/concat(
                    if (matches(($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@facs, '^facs:W\d{4}-\d{4}$')) then 
                        replace(($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@facs, '^facs:((W\d{4})-\d{4})$', '$2!$1')
                    else if (matches(($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@facs, '^facs:W\d{4}-[A-z]-\d{4}$')) then 
                        replace(($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@facs, '^facs:((W\d{4})-([A-z])-\d{4})$', '$2!$3!$1')
                    else error(),
                    '/full/full/0/default.jpg')
                </object> <!-- referring to *iiif* image (jpg) -->
	        </statement> 

            <statement n="304" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citeID])))}"> <!-- rdfs seeAlso www -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdfs">seeAlso</predicate>
                <object type="uri" prepend="https://www.salamanca.school/">/($currentResource//itei:pb[@citeID])[$repeatIndex]/@web</object>
	        </statement>

            <statement n="305" repeat="{/min((100020, count($currentResource[self::itei:text]//itei:pb[@citeID])))}"> <!-- iiif canvas -->
                <subject type="uri" prepend="texts/WXXXX:">/($currentResource[self::itei:text]//itei:pb[@citeID])[$repeatIndex]/@citeID</subject>
                <predicate prefix="rdf">type</predicate>
                <object type="uri" prefix="iiif">canvas</object>
            </statement>

            <!-- TODO/iiif:
                - Other iiif stuff: label, height, width, thumbnail, otherContent, startCanvas (per work, not per page)
                - blank node for image resource
                - blank node for annotation mentioning image resource
                - iiif:images contains annotations
            -->


<!-- ====================== -->
<!-- === IV. References === -->
<!-- ====================== -->

<!-- TODO/References:
    - render persons who are mentioned, but not cited as authors
    - cito:Citation instead of cito:CitationAct (deprecated?)
-->

             <!-- a. References within citations (<cit>): We render this with cito:includesQuotationFrom -->

             <!-- a.1. ... to work titles (-> CitationAct_a_XY-## blank nodes) -->

             <!-- SvSal works -->

    		 <statement n="401" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="402" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>

			 <statement n="403" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="texts/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])[$repeatIndex]/tokenize(tokenize(@ref, 'work:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="404" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'work:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

             <!-- OCLC works -->

			 <statement n="405" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="406" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>

			 <statement n="407" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://www.worldcat.org/oclc/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])[$repeatIndex]/tokenize(tokenize(@ref, 'oclc:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="408" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'oclc:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

             <!-- GND works -->

			 <statement n="409" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="410" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">includesQuotationFrom</object>
			 </statement>

			 <statement n="411" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="412" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_a_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:title[contains(@ref, 'gnd:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

             <!-- a.2. ... to authors (CitationAct_b_XY-## blank nodes) -->

            <!-- SvSal authors -->

            <statement n="413" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"> <!-- cito citationAct -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="414" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"><!-- ... of type ... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>

            <statement n="415" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"> <!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="authors.">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])[$repeatIndex]/tokenize(tokenize(@ref, 'author:')[2], ' ')[1]</object>
            </statement>

            <statement n="416" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])))}"><!-- ... where is the citation? -->
                <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
                <subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'author:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>

            <!-- Cerl authors -->

            <statement n="417" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="418" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>

            <statement n="419" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="http://thesaurus.cerl.org/record/">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])[$repeatIndex]/tokenize(tokenize(@ref, 'cerl:')[2], ' ')[1]</object>
            </statement>

            <statement n="420" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])))}"><!-- ... where is the citation? -->
            	<!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
                <subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'cerl:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>

            <!-- GND authors -->

            <statement n="421" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="422" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>
            
            <statement n="423" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
            </statement>

            <statement n="424" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])))}"><!-- ... where is the citation? -->
                <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            	<subject type="bnode">/concat('CitationAct_b_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:cit//itei:author//itei:persName[contains(@ref, 'gnd:')])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>


             <!-- b. References outside of citations: We render this with cito:citesAsRelated -->

             <!-- b.1. ... to work titles (-> CitationAct_c_XY-## blank nodes) -->

             <!-- SvSal works -->

    		 <statement n="425" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="426" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>

			 <statement n="427" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="texts/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'work:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="428" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-works-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'work:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

             <!-- OCLC works -->

			 <statement n="429" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="430" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>

			 <statement n="431" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://www.worldcat.org/oclc/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'oclc:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="432" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-oclc-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'oclc:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

             <!-- GND works -->

			 <statement n="433" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
    			<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
    			<predicate prefix="rdf">type</predicate>
    			<object type="uri" prefix="cito">citationAct</object>
    		 </statement>

			 <statement n="434" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitationCharacterization</predicate>
				<object type="uri" prefix="cito">citesAsRelated</object>
			 </statement>

			 <statement n="435" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
				<predicate prefix="cito">hasCitedEntity</predicate>
				<object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
			 </statement>

			 <statement n="436" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
				<subject type="bnode">/concat('CitationAct_c_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
		        <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:title[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
			 </statement>

            <!-- b.2. ... to authors (-> CitationAct_d_XY-## blank nodes) -->

            <!-- SvSal authors -->

            <statement n="437" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"> <!-- cito citationAct -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="438" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"><!-- ... of type ... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>

            <statement n="439" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"> <!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="authors.">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'author:')[2], ' ')[1]</object>
            </statement>

            <statement n="440" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
                <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
                <subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-authors-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'author:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>

            <!-- Cerl authors -->

            <statement n="441" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="442" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>

            <statement n="443" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
            	<object type="uri" prepend="http://thesaurus.cerl.org/record/">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'cerl:')[2], ' ')[1]</object>
            </statement>

            <statement n="444" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
                <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-cerl-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'cerl:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>

            <!-- GND authors -->

            <statement n="445" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- a CitationAct event... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="rdf">type</predicate>
            	<object type="uri" prefix="cito">citationAct</object>
            </statement>

            <statement n="446" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... of type... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitationCharacterization</predicate>
            	<object type="uri" prefix="cito">citesAsRelated</object>
            </statement>

            <statement n="447" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... what is cited? -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
            	<predicate prefix="cito">hasCitedEntity</predicate>
                <object type="uri" prepend="http://d-nb.info/gnd/">/($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/tokenize(tokenize(@ref, 'gnd:')[2], ' ')[1]</object>
            </statement>

            <statement n="448" repeat="{/min((100010, count($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])))}"><!-- ... where is the citation? -->
                <!-- choose only p or div as ancestors here? .../ancestor::*[self::itei:p or self::itei:div][1]/... -->
            	<subject type="bnode">/concat('CitationAct_d_', $currentResource[self::itei:text]/@in, '-gnd-', $repeatIndex)</subject>
                <predicate prefix="cito">hasCitingEntity</predicate> <!-- or po:isContainedBy? -->
                <object type="uri" prepend="texts/WXXXX:">/(($currentResource[self::itei:text]//itei:persName[contains(@ref, 'gnd:')][not(ancestor::itei:cit)])[$repeatIndex]/ancestor::itei:*[@citeID][1]/@citeID)</object>
            </statement>

            <!-- note: if hasCitingEntity only points to p|div ancestors (currently not the case), perhaps we should also include ancestor::itei:item[ancestor::itei:list/@type='dict'] -->

            <!-- TODO: viaf? -->

            <!-- c. References to non-literary entities (places, organizations etc.): We render this with book:mentions -->

            <!-- Getty places (independently of whether or not inside a citation) -->
            <statement n="449"> <!-- book mentions -->
                <subject type="uri" prepend="texts/">/(concat($currentResource[self::itei:text]/@in, if ($currentResource[self::itei:text]/@n) then concat(':vol', $currentResource/@n) else ()))</subject>
                <predicate prefix="book">mentions</predicate>
                <object type="uri" prepend="http://vocab.getty.edu/tgn/">/($currentResource[self::itei:text]//itei:placeName[contains(@ref, 'getty:')])/tokenize(tokenize(@ref, 'getty:')[2], ' ')[1]</object>
            </statement>

        </triples>
    </configuration>

    <!-- This is likely to be overwritten by createConfig.xql -->
    <collection>
        <resource uri="{//sal:index}"/>
    </collection>
    
</xtriples>